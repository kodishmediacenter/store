ó
ðâNWc           @   sn  d  d l  m Z m Z m Z d  d l m Z m Z m Z d Z d Z	 d „  Z
 e	 d „ Z e	 d „ Z e
 e _ e e _ e e _ d „  Z e	 d	 „ Z e	 d
 „ Z e e _ e e _ e e _ d „  Z e	 d „ Z e	 d „ Z e e _ e e _ e e _ d e f d „  ƒ  YZ d e f d „  ƒ  YZ d e f d „  ƒ  YZ d Z e d „ Z e e	 d „ Z e e	 d „ Z d S(   i   (   t   AESBlockModeOfOperationt   AESSegmentModeOfOperationt   AESStreamModeOfOperation(   t   append_PKCS7_paddingt   strip_PKCS7_paddingt   to_bufferablet   nonet   defaultc         C   s   | d k r d Sd S(   Ni   i    (    (   t   selft   size(    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   _block_can_consume6   s     c         C   s˜   | t  k r t | ƒ } n< | t k rK t | ƒ d k rW t d ƒ ‚ qW n t d ƒ ‚ t | ƒ d k r‹ |  j | d  ƒ |  j | d ƒ S|  j | ƒ S(   Ni   s#   invalid data length for final blocks   invalid padding optioni    (   t   PADDING_DEFAULTR   t   PADDING_NONEt   lent	   Exceptiont   encrypt(   R   t   datat   padding(    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   _block_final_encrypt;   s    "c         C   si   | t  k r t |  j | ƒ ƒ S| t k rY t | ƒ d k rL t d ƒ ‚ n  |  j | ƒ St d ƒ ‚ d  S(   Ni   s#   invalid data length for final blocks   invalid padding option(   R   R   t   decryptR   R   R   (   R   R   R   (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   _block_final_decryptK   s    c         C   s   |  j  t | |  j  ƒ S(   N(   t   segment_bytest   int(   R   R	   (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   _segment_can_consume^   s    c         C   sf   | t  k r t d ƒ ‚ n  t d ƒ |  j t | ƒ |  j } | t | ƒ } |  j | ƒ t | ƒ  S(   Ns   invalid padding optioni    (   R   R   t   chrR   R   R   R   (   R   R   R   t   faux_paddingt   padded(    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   _segment_final_encryptb   s
    $c         C   sf   | t  k r t d ƒ ‚ n  t d ƒ |  j t | ƒ |  j } | t | ƒ } |  j | ƒ t | ƒ  S(   Ns   invalid padding optioni    (   R   R   R   R   R   R   R   (   R   R   R   R   R   (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   _segment_final_decryptk   s
    $c         C   s   | S(   N(    (   R   R	   (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   _stream_can_consume{   s    c         C   s.   | t  t g k r! t d ƒ ‚ n  |  j | ƒ S(   Ns   invalid padding option(   R   R   R   R   (   R   R   R   (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   _stream_final_encrypt~   s    c         C   s.   | t  t g k r! t d ƒ ‚ n  |  j | ƒ S(   Ns   invalid padding option(   R   R   R   R   (   R   R   R   (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   _stream_final_decrypt„   s    t   BlockFeederc           B   s&   e  Z d  Z e d „ Z d d „ Z RS(   sÆ   The super-class for objects to handle chunking a stream of bytes
       into the appropriate block size for the underlying mode of operation
       and applying (or stripping) padding, as necessary.c         C   s7   | |  _  | |  _ | |  _ t d ƒ |  _ | |  _ d  S(   Nt    (   t   _modet   _feedt   _finalR   t   _buffert   _padding(   R   t   modet   feedt   finalR   (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   __init__•   s
    			c         C   sã   |  j  d k r t d ƒ ‚ n  | sI |  j |  j  |  j ƒ } d |  _  | S|  j  t | ƒ 7_  t d ƒ } xr t |  j  ƒ d k rÞ |  j j t |  j  ƒ d ƒ } | d k r± Pn  | |  j	 |  j  |  ƒ 7} |  j  | |  _  qm W| S(   s  Provide bytes to encrypt (or decrypt), returning any bytes
           possible from this or any previous calls to feed.

           Call with None or an empty string to flush the mode of
           operation and return any final bytes; no further calls to
           feed may be made.s   already finished feederR!   i   i    N(
   R%   t   Nonet
   ValueErrorR$   R&   R   R   R"   t   _can_consumeR#   (   R   R   t   resultt   can_consume(    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyR(   œ   s    	 N(   t   __name__t
   __module__t   __doc__R   R*   R+   R(   (    (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyR       s   t	   Encrypterc           B   s   e  Z d  Z e d „ Z RS(   s<   Accepts bytes of plaintext and returns encrypted ciphertext.c         C   s#   t  j |  | | j | j | ƒ d  S(   N(   R    R*   R   t   _final_encrypt(   R   R'   R   (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyR*   ½   s    (   R0   R1   R2   R   R*   (    (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyR3   º   s   t	   Decrypterc           B   s   e  Z d  Z e d „ Z RS(   s<   Accepts bytes of ciphertext and returns decrypted plaintext.c         C   s#   t  j |  | | j | j | ƒ d  S(   N(   R    R*   R   t   _final_decrypt(   R   R'   R   (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyR*   Ä   s    (   R0   R1   R2   R   R*   (    (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyR5   Á   s   i   c         C   s_   x? t  rA | j | ƒ } | s" Pn  |  j | ƒ } | j | ƒ q W|  j ƒ  } | j | ƒ d S(   sG   Uses feeder to read and convert from in_stream and write to out_stream.N(   t   Truet   readR(   t   write(   t   feedert	   in_streamt
   out_streamt
   block_sizet   chunkt	   converted(    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   _feed_streamË   s    	c         C   s)   t  |  d | ƒ} t | | | | ƒ d S(   sC   Encrypts a stream of bytes from in_stream to out_stream using mode.R   N(   R3   R@   (   R'   R;   R<   R=   R   t	   encrypter(    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   encrypt_streamØ   s    c         C   s)   t  |  d | ƒ} t | | | | ƒ d S(   sC   Decrypts a stream of bytes from in_stream to out_stream using mode.R   N(   R5   R@   (   R'   R;   R<   R=   R   t	   decrypter(    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   decrypt_streamß   s    Ni    (   t   aesR    R   R   t   utilR   R   R   R   R   R
   R   R   R-   R4   R6   R   R   R   R   R   R   t   objectR    R3   R5   t
   BLOCK_SIZER@   RB   RD   (    (    (    s_   C:\Users\shani\AppData\Roaming\Kodi\addons\plugin.video.live.RSIPTV\pyaesnew\blockfeeder.pyt   <module>   s8   													*